---
title: 图解密码技术（六）--单向散列函数&消息认证码
time: 2021/11/8 10:20:00
tag: 密码学
description: 就说了认证的时候需要的单向散列函数啊啥的
category: 学习笔记
cover: /imgs/feng5.jpgz
---

{% note green info %}

在认证的时候，需要认证的主要有，消息是不是原始消息、消息是不是这个人发的啥的

{% endnote %}

## 7.1 单向散列函数的性质

> 单向散列函数主要是为了验证这个消息是不是被篡改，也就是“完整性”

#### 👉消息不同散列值也不同

**碰撞**：两个不同的消息产生相同的散列值

##### 两种碰撞

* 弱抗碰撞性：要找到和该消息具有相同散列值的另一条消息的非常困难的（指定一个对象找另一个对象）
* 强碰撞性：在所有的空间里，找到两个相同散列值的消息是非常困难的（在整个群体中找到相同的散列值很难）

#### 👉单向性

  已知散列值，想恢复是很难的。（不能互逆）

**指纹**：单向三列函数输出的散列值，叫指纹，或消息摘要



---

抗碰撞性，如果设计一种“不能碰撞”的单向散列函数可以吗?

不可以，不能碰撞的单向散列函数是不存在的。空间只有那么大，算的时候多出来一个，那么肯定会有一个相同的，也就是数量足够大就会碰撞（**鸽巢原理**）

---

**鸽巢原理：**有n个巢，n+1个鸽子，那必然有两个鸽子是在一个巢里。

**杂错函数：**就是映射要尽可能的乱。



## 7.3 单向散列函数的作用

1. 检查文件是否被篡改

2. 基于口令的加密（PED）

   PED的原理是将口令和盐（为了防止密码太简单加的一个随机数列），生成一个秘钥。这样可以防御针对口令的字典攻击。

3. 消息认证码

   发送者和接受者之间的共享秘钥和消息进行混合后计算出的散列值

4. 数字签名

5. 伪随机数生成器

   就是，事实上不可能根据过去的随机数列预测未来的随机数列。

   *//优化理论*

   *//随机数：就是不可能预测的数。*

6. 一次性口令

   口令只在通信链路上传送一次。



## 7.4 单向散列函数的具体例子

#### MD4、MD5

#### SHA-1、SHA-256、SHA-384、SHA-512

SHA-1已经不推荐使用了，现在用的SHA-256

#### RIPEMD-160

#### SHA-3

...

#### Keccak

公开征集



## 应该使用哪种单向散列函数？

MD5，不安全。应该都用SHA-256



## 7.8 对单向散列函数的攻击

### 👉暴力攻击（弱碰撞性攻击）

**冗余性：**在不改变文档意思的前提下，对文档内容进行修改

利用冗余性生成一大堆与想要改的意思相同的消息，找到一个相同的散列值的句子，替换原来的消息

利用冗余性，找一个哈希值一样的，换掉。

### 👉生日攻击

有一堆人在一起，超过一半的可能性，两个人的生日一样，只要23个人。也就是找到一个与原来消息相同散列值的消息，进行替换。

**生日悖论：**任意两个人生日相同的概率远大于我们想的



## 7.9 单向散列函数无法解决的问题

可以辨别篡改（发送的消息是否被篡改），无法辨别伪装（是不是发送人发的）。



{% note blue 'fas fa-broom' simple %}

## 第八章 消息认证码

{% endnote %}

### 消息认证码

> 指消息来自正确的发送者

### 8.2.2 什么是消息认证码（MAC）

是一种确认完整性并进行认证的技术，是一种与秘钥相关联的单向散列函数。函数是两个变量。。。

![单向散列函数与消息认证码的比较](image-20211114221025129.png)

#### 秘钥配送问题

不好解决



### 消息认证码的实现



### 重放攻击（对有认证码的消息进行攻击）

将事先保存的MAC值不断的重放来发动攻击。

* 攻击者，先在一个银行1里申请汇款信息。
* 银行1发送了一个汇款的信息向银行2
* 攻击者截获了银行1发送给银行2的信息的MAC值
* 银行2汇款给攻击者
* 攻击者使用截获的MAC值，模拟银行1向银行2发送汇款请求
* 银行2检查MAC值正确，进行汇款动作
* 攻击者重复发送，银行2重复动作



虚拟币花很多次（？）

攻击比特币里也会用到。。。

#### 如何解决

1. 在每次进行的时候增加一个序号
2. 增加一个时间戳
3. 加一个随机序列

### 秘钥推测攻击

对消息认证码进行暴力破解及生日攻击

如果能从MAC值反算出秘钥，就可以攻击

在生成秘钥时要使用高强度的



### 消息认证码的缺点

1. 向第三方证明

   向第三方人证明消息确实是发送者发送的。因为有个共享秘钥，仅靠MAC值是不知道是谁发的。😁

2. 防止否认

   发送者说自己没发过这个消息

认证码保证了来源的可靠性，但是也不是完全能证明。



{% note blue 'fas fa-broom' simple %}

# 第九章 数字签名

{% endnote %}

> 解决消息到底是谁写的的问题
>
> 因为消息认证码**不能防止否认**（因为两人共享一个秘钥）

## 9.1 通过数字签名解决问题

  让发送者和接收者使用不同的秘钥

* 发送者使用自己的私钥生成一个签名
* 接收者可以使用自己的秘钥对发送者的签名进行验证



> **autograph&signature的区别**



注意公钥加密和数字签名的区别

![公钥](image-20211114221457679.png)

![数字签名](image-20211114221516414.png)



#### 数字签名的方法

* 直接对消息进行签名（所有的字节）
* 对哈希值进行签名（16个字节）



<font color="green">//就是，发送者用自己的**私钥**进行数字签名，接收者收到消息之后用发送者的公钥解密，就可以知道这个数字签名是不是真的，所以发送者也不用将自己的私钥发给接收者，也能解决消息认证吗的否定的问题</font>



### 一些问题

#### 数字签名可以复制吗

可以，但是数字签名之后的消息只能表示在某个特定时间段的某个特定的事

#### 数字签名被任意修改的问题

可以修改。但是在验证的时候会出现问题

#### 签名会不会被重复利用

可以，但是别人可以识别，和复制的那个一样

#### 删除签名也无法作废合同的问题

就算已经没有这个合同的效力了，但是数字签名还在电脑里有效力。所以就要创建一份合同已经作废的说明，创建一份新的数字签名。

#### 如何防止否认

如果说私钥被窃取了，可以否认。。。（听说法律上有规定）

#### 数字签名能代替签名吗

确实需要解决问题😊

这种技术只有被人们广泛认知，才能解决问题，被社会接受。完全取代也不太行。😊